{% load static %}
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<style>
    .chart-container {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
    }
    .chart-card {
        background: white;
        border-radius: 10px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        padding: 20px;
        width: 100%;
        max-width: 700px;
        transition: transform 0.2s;
    }

    .chart {
        height: 400px;
    }
</style>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<div class="chart-container my-8 flex justify-center">
    <div class="chart-card">
        <div class="font-bold text-2xl text-blue-800 text-center">
            <p class="mb-8"><img src="{% static 'images/d.png' %}" alt="Image" class="h-8 w-8" style="display: inline;"> Total Count </p>
        </div>
        <canvas id="total-products-chart" class="chart"></canvas>
    </div>

    <div class="chart-card">
        <div class="font-bold text-2xl text-blue-800 text-center">
            <p class="mb-8"><img src="{% static 'images/d.png' %}" alt="Image" class="h-8 w-8" style="display: inline;"> Category Distribution </p>
        </div>
        <div id="category-distribution-chart" class="chart"></div>
    </div>
</div>
<script>
    var totalProductsData = JSON.parse('{{ total_products_data|escapejs }}');
    var labels = ['Products', 'Suppliers', 'Categories'];
    var data = totalProductsData[0].y;

    var ctx = document.getElementById('total-products-chart').getContext('2d');
    var chart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [{
                label: 'Total Count',
                data: data,
                backgroundColor: ['#008080', '#FF69B4', '#FFF176', '#FFF176', '#2196F3', '#5C6BC0', '#9C27B0']
            }]
        },
        options: {
            responsive: true,
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });

    var categoryLabels = JSON.parse('{{ category_labels|escapejs }}');
    var categoryValues = JSON.parse('{{ category_values|escapejs }}');
    var categoryData = [{
        type: 'pie',
        labels: categoryLabels,
        values: categoryValues,
        textinfo: 'label+percent',
        text: categoryValues.map(value => value > 0 ? `${value}%` : ''),
        hoverinfo: 'label+percent',
        marker: {
            colors: ['#008080', '#FF69B4', '#E57373', '#FFF176', '#2196F3', '#5C6BC0', '#9C27B0']
        }
    }];
    Plotly.newPlot('category-distribution-chart', categoryData);
</script>
