{% extends 'Product/base.html' %}
{% load static %}
{% block title %}
  Dashboard
{% endblock %}
{% block content %}
  <div class="container mx-auto px-4 py-8">
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
      <!-- Total Products -->
      <div class="bg-white rounded-lg shadow-md p-6 transition-transform transform hover:scale-105 duration-300 ease-in-out">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-semibold text-gray-800">Total Products</h3>
          <div class="p-3 bg-green-100 rounded-full">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"></path>
            </svg>
          </div>
        </div>
        <p class="text-3xl font-bold text-gray-900">{{ total_products }}</p>
      </div>

      <!-- Total Suppliers -->
      <div class="bg-white rounded-lg shadow-md p-6 transition-transform transform hover:scale-105 duration-300 ease-in-out">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-semibold text-gray-800">Total Suppliers</h3>
          <div class="p-3 bg-blue-100 rounded-full">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
            </svg>
          </div>
        </div>
        <p class="text-3xl font-bold text-gray-900">{{ total_suppliers }}</p>
      </div>

      <!-- Total Categories -->
      <div class="bg-white rounded-lg shadow-md p-6 transition-transform transform hover:scale-105 duration-300 ease-in-out">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-semibold text-gray-800">Total Categories</h3>
          <div class="p-3 bg-indigo-200 rounded-full">
            <img src="{% static 'images/catgory.png' %}" alt="Category" class="h-6 w-6" />
          </div>
        </div>
        <p class="text-3xl font-bold text-gray-900">{{ total_categories }}</p>
      </div>

      <!-- Stock Status -->
      <div class="bg-white rounded-lg shadow-md p-6 transition-transform transform hover:scale-105 duration-300 ease-in-out">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-semibold text-gray-800">Stock Status</h3>
          <div class="p-3 bg-black rounded-full">
            <img src="{% static 'images/product.png' %}" alt="Product" class="h-6 w-6" />
          </div>
        </div>
        <p class="text-3xl font-bold text-gray-900">{{ stock_status|floatformat:2 }}%</p>
      </div>

      <!-- Total Revenue -->
      <div class="bg-white rounded-lg shadow-md p-6 transition-transform transform hover:scale-105 duration-300 ease-in-out">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-semibold text-gray-800">Total Revenue</h3>
          <div class="p-3 bg-yellow-400 rounded-full">
            <img src="{% static 'images/money.png' %}" alt="Money" class="h-6 w-6" />
          </div>
        </div>
        <p class="text-3xl font-bold text-gray-900">${{ total_revenue|floatformat:2 }}</p>
      </div>

      <!-- Average Product Price -->
      <div class="bg-white rounded-lg shadow-md p-6 transition-transform transform hover:scale-105 duration-300 ease-in-out">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-semibold text-gray-800">Avg. Product Price</h3>
          <div class="p-3 bg-purple-100 rounded-full">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-purple-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 3h2M5 6h14M7 9h10M9 12h6M11 15h2M13 18h-2"></path>
            </svg>
          </div>
        </div>
        <p class="text-3xl font-bold text-gray-900">${{ average_product_price|floatformat:2 }}</p>
      </div>

      <!-- Top Category -->
      <div class="bg-white rounded-lg shadow-md p-6 transition-transform transform hover:scale-105 duration-300 ease-in-out">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-semibold text-gray-800">Top Category</h3>
          <div class="p-3 bg-teal-100 rounded-full">
            <img src="{% static 'images/trending_up.png' %}" alt="Trending Up" class="h-6 w-6" />
          </div>
        </div>
        <p class="text-xl font-bold text-gray-900">{{ top_category }}</p>
      </div>

      <div class="bg-white rounded-lg shadow-md p-6 transition-transform transform hover:scale-105 duration-300 ease-in-out">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-semibold text-gray-800">Lowest Price</h3>
          <div class="p-3 bg-teal-100 rounded-full">
            <img src="{% static 'images/money.png' %}" alt="Trending Up" class="h-6 w-6" />
          </div>
        </div>
        <p class="text-xl font-bold text-gray-900">{{ low_price }}</p>
      </div>

      <!-- Lower Category -->
      <div class="bg-white rounded-lg shadow-md p-6 transition-transform transform hover:scale-105 duration-300 ease-in-out">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-semibold text-gray-800">Lower Category</h3>
          <div class="p-3 bg-pink-100 rounded-full">
            <img src="{% static 'images/down.png' %}" alt="Down" class="h-6 w-6" />
          </div>
        </div>
        <p class="text-xl font-bold text-gray-900">{{ lower_category }}</p>
      </div>


            <!-- high_price  -->
      <div class="bg-white rounded-lg shadow-md p-6 transition-transform transform hover:scale-105 duration-300 ease-in-out">
        <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-semibold text-gray-800">Highest Price</h3>
          <div class="p-3 bg-green-400 rounded-full">
            <img src="{% static 'images/money.png' %}" alt="Down" class="h-6 w-6" />
          </div>
        </div>
        <p class="text-xl font-bold text-gray-900">{{ high_price }}</p>
      </div>



        <!-- Top Supplier  -->
      <div class="bg-white rounded-lg shadow-md p-6 transition-transform transform hover:scale-105 duration-300 ease-in-out">
        <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-semibold text-gray-800">Top Supplier</h3>
          <div class="p-3 bg-teal-400 rounded-full">
            <img src="{% static 'images/trending_up.png' %}" alt="Down" class="h-6 w-6" />
          </div>
        </div>
        <p class="text-xl font-bold text-gray-900">{{ top_supplier }}</p>
      </div>


      <!-- Lower Supplier  -->
      <div class="bg-white rounded-lg shadow-md p-6 transition-transform transform hover:scale-105 duration-300 ease-in-out">
        <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-semibold text-gray-800">Lower Supplier</h3>
          <div class="p-3 bg-pink-400 rounded-full">
            <img src="{% static 'images/down.png' %}" alt="Down" class="h-6 w-6" />
          </div>
        </div>
        <p class="text-xl font-bold text-gray-900">{{ lower_supplier }}</p>
      </div>
    </div>

    <!-- Recent Products Table -->
    <div class="mt-12 bg-white rounded-xl shadow-lg overflow-hidden">
      <h2 class="text-2xl font-semibold text-gray-800 p-6 bg-gray-50 border-b border-gray-200">Recent Products</h2>
      <div class="overflow-x-auto">
        <table class="w-full">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Category</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Price</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Stock</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Added Date</th>
            </tr>
          </thead>
          <tbody class="bg-white divide-y divide-gray-200">
            {% for product in last_five_products %}
              <tr class="hover:bg-gray-50 transition-colors duration-200">
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ product.name }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ product.category.name }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${{ product.price|floatformat:2 }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ product.stock_quantity }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{ product.created_at|date:"Y-m-d H:i" }}</td>
              </tr>
            {% empty %}
              <tr>
                <td colspan="5" class="px-6 py-4 text-center text-sm text-gray-500">No products found.</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>

  {% load static %}
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }
    .chart-container {
      padding: 24px;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 24px;
      margin-top: 24px;
    }
    .chart-card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      padding: 20px;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .chart-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
    }
    .chart {
      width: 100%;
      height: 250px;
    }
    .chart-title {
      font-weight: 600;
      font-size: 1.25rem;
      color: #374151;
      text-align: center;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .chart-title img {
      margin-right: 10px;
    }
  </style>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <div class="chart-container">
    <!-- Total Count Chart -->
    <div class="chart-card">
      <div class="chart-title">
        <img src="{% static 'images/d.png' %}" alt="Image" class="h-6 w-6"> Total Count
      </div>
      <canvas id="total-products-chart" class="chart"></canvas>
    </div>

    <!-- Monthly Sales Chart -->
    <div class="chart-card">
      <div class="chart-title">
        <img src="{% static 'images/d.png' %}" alt="Image" class="h-6 w-6"> Monthly Sales
      </div>
      <canvas id="line-chart" class="chart"></canvas>
    </div>

    <!-- Category Distribution Chart -->
    <div class="chart-card">
      <div class="chart-title">
        <img src="{% static 'images/d.png' %}" alt="Image" class="h-6 w-6"> Category Distribution
      </div>
      <canvas id="category-distribution-chart" class="chart"></canvas>
    </div>

    <!-- Doughnut Chart -->
    <div class="chart-card">
      <div class="chart-title">
        <img src="{% static 'images/d.png' %}" alt="Image" class="h-6 w-6"> Product Categories
      </div>
      <canvas id="doughnut-chart" class="chart"></canvas>
    </div>
  </div>

  <script>
    // Total Count Chart
    var totalProductsData = JSON.parse('{{ total_products_data|escapejs }}');
    var labels = ['Products', 'Suppliers', 'Categories'];
    var data = totalProductsData[0].y;

    var ctx = document.getElementById('total-products-chart').getContext('2d');
    var totalProductsChart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: labels,
        datasets: [{
          label: 'Total Count',
          data: data,
          backgroundColor: ['#3B82F6', '#10B981', '#F59E0B']
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: {
            display: false
          }
        },
        scales: {
          y: {
            beginAtZero: true
          }
        }
      }
    });

    // Category Distribution Pie Chart
    var categoryLabels = JSON.parse('{{ category_labels|escapejs }}');
    var categoryValues = JSON.parse('{{ category_values|escapejs }}');

    var ctx2 = document.getElementById('category-distribution-chart').getContext('2d');
    var categoryDistributionChart = new Chart(ctx2, {
      type: 'pie',
      data: {
        labels: categoryLabels,
        datasets: [{
          data: categoryValues,
          backgroundColor: ['#3B82F6', '#10B981', '#F59E0B', '#EF4444', '#8B5CF6', '#EC4899', '#6366F1', '#14B8A6', '#F97316', '#84CC16', '#64748B']
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: {
            position: 'right',
          },
          tooltip: {
            callbacks: {
              label: function(tooltipItem) {
                return categoryLabels[tooltipItem.dataIndex] + ': ' + categoryValues[tooltipItem.dataIndex] + '%';
              }
            }
          }
        }
      }
    });

    // Monthly Sales Line Chart
    var lineLabels = ['January', 'February', 'March', 'April', 'May', 'June', 'July'];
    var lineData = [30, 45, 32, 50, 70, 65, 85];

    var ctx3 = document.getElementById('line-chart').getContext('2d');
    var lineChart = new Chart(ctx3, {
      type: 'line',
      data: {
        labels: lineLabels,
        datasets: [{
          label: 'Monthly Sales',
          data: lineData,
          borderColor: '#3B82F6',
          backgroundColor: 'rgba(59, 130, 246, 0.1)',
          borderWidth: 2,
          fill: true,
          tension: 0.4
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: {
            display: false
          }
        },
        scales: {
          y: {
            beginAtZero: true
          }
        }
      }
    });

    // Product Categories Doughnut Chart
    var doughnutLabels = ['Electronics', 'Clothing', 'Food', 'Books', 'Others'];
    var doughnutData = [30, 25, 20, 15, 10];

    var ctx4 = document.getElementById('doughnut-chart').getContext('2d');
    var doughnutChart = new Chart(ctx4, {
      type: 'doughnut',
      data: {
        labels: doughnutLabels,
        datasets: [{
          data: doughnutData,
          backgroundColor: ['#3B82F6', '#10B981', '#F59E0B', '#EF4444', '#8B5CF6']
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: {
            position: 'right',
          }
        }
      }
    });
  </script>
{% endblock %}
